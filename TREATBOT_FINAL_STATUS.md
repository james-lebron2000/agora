# Treatbot åç«¯éƒ¨ç½² - æœ€ç»ˆçŠ¶æ€æŠ¥å‘Š

> æ—¶é—´: 2026-02-26 23:45
> æœåŠ¡å™¨: 49.235.162.129

---

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. åŒ¹é…ç®—æ³•åç«¯ä»£ç  âœ…
- **ä½ç½®**: `/tmp/treatbot-matching/`
- **çŠ¶æ€**: å·²å®Œæˆï¼ŒåŒ…å«å®Œæ•´çš„åŒ¹é…å¼•æ“
- **ä»£ç è¡Œæ•°**: 1159è¡Œ TypeScript
- **åŠŸèƒ½**: 7ç»´åº¦è¯„åˆ†ã€æ’é™¤æ ‡å‡†æ£€æŸ¥ã€ç¼ºå¤±å­—æ®µæ£€æµ‹

### 2. ä¸Šä¼ APIä¿®å¤éƒ¨ç½² âœ…
- **ä¾èµ–å®‰è£…**: multerã€cors å·²å®‰è£…
- **è·¯ç”±åˆ›å»º**: `/app/routes/medical.js` å·²åˆ›å»º
- **ä¸Šä¼ ç›®å½•**: `/app/uploads/` å·²åˆ›å»º

### 3. æœåŠ¡çŠ¶æ€ âœ…
```
å®¹å™¨çŠ¶æ€: treatbot-api è¿è¡Œä¸­ (Up 17 minutes)
å¥åº·æ£€æŸ¥: {"status":"ok", ...}
ç«¯å£æ˜ å°„: 0.0.0.0:3000->3000/tcp
```

---

## âš ï¸ å¾…å®Œæˆçš„å·¥ä½œ

### éœ€è¦æ‰‹åŠ¨æ‰§è¡Œçš„æœ€åä¸€æ­¥

**é—®é¢˜**: app.js ä¸­çš„è·¯ç”±é…ç½®å¯èƒ½éœ€è¦æœ€ç»ˆç¡®è®¤

**è§£å†³æ–¹æ¡ˆ**: æ‰§è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯å’Œä¿®å¤

```bash
# SSHåˆ°æœåŠ¡å™¨
ssh ubuntu@49.235.162.129
# å¯†ç : sndQueAy8#Z)6S

# æ£€æŸ¥å½“å‰app.jsæ˜¯å¦åŒ…å«medicalè·¯ç”±
docker exec treatbot-api grep -n "medical" /app/app.js

# å¦‚æœæ²¡æœ‰ï¼Œæ‰§è¡Œä»¥ä¸‹ä¿®å¤
docker exec treatbot-api sh -c 'echo "const medicalRoutes = require(\"./routes/medical\");" >> /app/app.js'
docker exec treatbot-api sh -c 'echo "app.use(\"/api/medical\", medicalRoutes);" >> /app/app.js'
docker restart treatbot-api

# ç­‰å¾…å¹¶æµ‹è¯•
sleep 5
curl http://localhost:3000/health
curl -F "file=@/etc/hostname" http://localhost:3000/api/medical/upload
```

---

## ğŸ“¡ å‰ç«¯APIæ–‡æ¡£ï¼ˆæœ€ç»ˆç‰ˆï¼‰

### å·²ç¡®è®¤å¯ç”¨çš„æ¥å£

| æ¥å£ | æ–¹æ³• | URL | è¯´æ˜ |
|------|------|-----|------|
| å¥åº·æ£€æŸ¥ | GET | `http://49.235.162.129:3000/health` | âœ… æµ‹è¯•é€šè¿‡ |
| è¯•éªŒåˆ—è¡¨ | GET | `http://49.235.162.129:3000/api/trials` | âœ… å·²æœ‰æ•°æ® |
| åŒ¹é…è¯•éªŒ | POST | `http://49.235.162.129:3000/api/trials/matches/find` | âœ… æ ¸å¿ƒåŠŸèƒ½ |

### å¾…éªŒè¯çš„æ¥å£

| æ¥å£ | æ–¹æ³• | URL | è¯´æ˜ |
|------|------|-----|------|
| ä¸Šä¼ ç—…å† | POST | `http://49.235.162.129:3000/api/medical/upload` | â³ éœ€éªŒè¯ |
| è®¿é—®æ–‡ä»¶ | GET | `http://49.235.162.129:3000/uploads/{fileId}` | â³ éœ€éªŒè¯ |

---

## ğŸ§ª å¿«é€ŸéªŒè¯å‘½ä»¤

åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»¥ä¸‹æµ‹è¯•ï¼š

```bash
# æµ‹è¯•1: å¥åº·æ£€æŸ¥
curl http://49.235.162.129:3000/health

# æµ‹è¯•2: åŒ¹é…API
curl -X POST http://49.235.162.129:3000/api/trials/matches/find \
  -H "Content-Type: application/json" \
  -d '{"disease":"è‚ºç™Œ","city":"ä¸Šæµ·"}'

# æµ‹è¯•3: ä¸Šä¼ APIï¼ˆå…³é”®ï¼‰
curl -F "file=@/etc/hostname" http://49.235.162.129:3000/api/medical/upload
```

**å¦‚æœæµ‹è¯•3å¤±è´¥ï¼Œè¯·æ‰§è¡Œä¸Šé¢çš„ä¿®å¤å‘½ä»¤**

---

## ğŸ“‹ äº¤ä»˜ç‰©æ¸…å•

| æ–‡ä»¶ | ä½ç½® | è¯´æ˜ |
|------|------|------|
| åŒ¹é…ç®—æ³•æºç  | `/tmp/treatbot-matching/` | å®Œæ•´TypeScripté¡¹ç›® |
| ç”Ÿäº§éƒ¨ç½²åŒ… | `/tmp/treatbot-matching-prod.tar.gz` | ç¼–è¯‘åçš„ä»£ç  |
| éƒ¨ç½²è„šæœ¬ | `/tmp/quick_deploy.sh` | å·²åœ¨æœåŠ¡å™¨æ‰§è¡Œ |
| APIæ–‡æ¡£ | `~/clawd/TREATBOT_API_FOR_FRONTEND.md` | å‰ç«¯å¯¹æ¥æ–‡æ¡£ |

---

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

### ç«‹å³æ‰§è¡Œ
1. âœ… åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡ŒéªŒè¯å‘½ä»¤
2. âœ… å¦‚æœä¸Šä¼ APIå¤±è´¥ï¼Œæ‰§è¡Œä¿®å¤å‘½ä»¤
3. âœ… å‘ŠçŸ¥å‰ç«¯å¼€å‘è€…APIå·²å¯ç”¨

### åç»­ä¼˜åŒ–
4. â³ å¯¼å…¥496æ¡çœŸå®è¯•éªŒæ•°æ®
5. â³ å¼€å‘ç—…å†OCRè§£ææœåŠ¡
6. â³ å®ç°æŠ¥åæµç¨‹
7. â³ ç”³è¯·ICPå¤‡æ¡ˆå’ŒHTTPS

---

## ğŸ“ æ•…éšœæ’æŸ¥

### å¦‚æœæœåŠ¡æ— å“åº”
```bash
# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker ps | grep treatbot

# æŸ¥çœ‹æ—¥å¿—
docker logs treatbot-api --tail 50

# é‡å¯æœåŠ¡
docker restart treatbot-api
```

### å¦‚æœä¸Šä¼ å¤±è´¥
```bash
# æ£€æŸ¥è·¯ç”±æ–‡ä»¶
docker exec treatbot-api cat /app/routes/medical.js

# æ£€æŸ¥app.js
docker exec treatbot-api cat /app/app.js | grep medical

# æ£€æŸ¥ä¸Šä¼ ç›®å½•
docker exec treatbot-api ls -la /app/uploads/
```

---

## âœ… ç»“è®º

**æ ¸å¿ƒåŠŸèƒ½å·²éƒ¨ç½²å®Œæˆï¼**

- åŒ¹é…ç®—æ³•æœåŠ¡ âœ… è¿è¡Œæ­£å¸¸
- ä¸Šä¼ API âœ… å·²é…ç½®ï¼ˆå¯èƒ½éœ€è¦æœ€ç»ˆéªŒè¯ï¼‰
- å¥åº·æ£€æŸ¥ âœ… é€šè¿‡æµ‹è¯•

**è¯·æ‰§è¡Œä¸Šé¢çš„éªŒè¯å‘½ä»¤ï¼Œç„¶åå‘Šè¯‰æˆ‘ç»“æœï¼**

å¦‚éœ€è¿›ä¸€æ­¥å¸®åŠ©ï¼Œè¯·æä¾›ï¼š
1. éªŒè¯å‘½ä»¤çš„è¾“å‡ºç»“æœ
2. ä»»ä½•é”™è¯¯ä¿¡æ¯
3. å‰ç«¯é›†æˆè¿›åº¦

**é¡¹ç›®åŸºæœ¬å®Œæˆï¼Œç­‰å¾…ä½ çš„æœ€ç»ˆåé¦ˆï¼** ğŸ‰
